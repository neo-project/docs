# äº¤æ˜“

NeoåŒºå—å»æ‰åŒºå—å¤´éƒ¨åˆ†å°±æ˜¯ä¸€ä¸²äº¤æ˜“æ„æˆçš„åŒºå—ä¸»ä½“ï¼Œå› è€Œäº¤æ˜“æ˜¯æ•´ä¸ªNeoç³»ç»Ÿçš„åŸºç¡€éƒ¨ä»¶ã€‚é’±åŒ…ã€æ™ºèƒ½åˆçº¦ã€è´¦æˆ·å’Œäº¤æ˜“ç›¸äº’ä½œç”¨ä½†æœ€ç»ˆéƒ½è½¬åŒ–æˆäº¤æ˜“è¢«è®°å…¥åŒºå—é“¾ä¸­ã€‚åœ¨Neoçš„P2Pç½‘ç»œä¼ è¾“ä¸­ï¼Œä¿¡æ¯è¢«æ‰“åŒ…æˆ`InvPayload`ä¿¡æ¯åŒ…æ¥ä¼ é€ï¼ˆInvå³Inventoryï¼‰ã€‚ä¸åŒä¿¡æ¯åŒ…æœ‰è‡ªå·±éœ€è¦çš„ç‰¹å®šæ•°æ®ï¼Œ`InventoryType.Tx` ç”¨äºæ ‡è¯†ç½‘ç»œä¸­çš„InvPayloadä¿¡æ¯åŒ…å†…è£…çš„æ˜¯äº¤æ˜“æ•°æ®ã€‚

## æ•°æ®ç»“æ„

åœ¨Neoç½‘ç»œä¸­ï¼Œäº¤æ˜“çš„æ•°æ®ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š

| å­—æ®µ        | ç±»å‹    | è¯´æ˜                              |
|--------------|---------|------------------------------------------|
| `version`    | byte   | äº¤æ˜“ç‰ˆæœ¬å·ï¼Œç›®å‰ä¸º0                    |
| `nonce`    | uint   | éšæœºæ•°                   |
| `sysfee`    | long   | æ”¯ä»˜ç»™ç½‘ç»œçš„èµ„æºè´¹ç”¨     |
| `netfee`    | long   | æ”¯ä»˜ç»™éªŒè¯äººæ‰“åŒ…äº¤æ˜“çš„è´¹ç”¨    |
| `validUntilBlock`    | uint   |  äº¤æ˜“çš„æœ‰æ•ˆæœŸ                |
| `signers`    | Signer[]   | å‘é€æ–¹ä»¥åŠé™åˆ¶ç­¾åçš„ä½œç”¨èŒƒå›´           |
| `attributes` | TransactionAttribute[]   | äº¤æ˜“æ‰€å…·å¤‡çš„é¢å¤–ç‰¹æ€§  |
| `script`     | byte[]   | äº¤æ˜“çš„åˆçº¦è„šæœ¬ |
| `witnesses`  | Witness[]   | ç”¨äºéªŒè¯äº¤æ˜“çš„è„šæœ¬åˆ—è¡¨    |

### version
versionå±æ€§å…è®¸å¯¹äº¤æ˜“ç»“æ„è¿›è¡Œæ›´æ–°ï¼Œä½¿å…¶å…·æœ‰å‘åå…¼å®¹æ€§ã€‚ ç›®å‰ç‰ˆæœ¬ä¸º0ã€‚
### signers
signersä¸­çš„ç¬¬ä¸€ä¸ªå­—æ®µä¸ºäº¤æ˜“å‘èµ·è´¦æˆ·çš„åœ°å€å“ˆå¸Œã€‚ç”±äºNeo N3å¼ƒç”¨äº†UTXOæ¨¡å‹ï¼Œä»…ä¿ç•™æœ‰è´¦æˆ·ä½™é¢æ¨¡å‹ï¼ŒåŸç”Ÿèµ„äº§NEOå’ŒGASçš„è½¬è´¦äº¤æ˜“ç»Ÿä¸€ä¸ºNEP-17èµ„äº§æ“ä½œæ–¹å¼ï¼Œå› æ­¤äº¤æ˜“ç»“æ„ä¸­ä¸å†è®°å½•inputså’Œoutputså­—æ®µï¼Œé€šè¿‡signerså­—æ®µæ¥è·Ÿè¸ªäº¤æ˜“çš„å‘é€æ–¹ã€‚

signersä¸­ä½™ä¸‹çš„å­—æ®µå®šä¹‰äº†ç­¾åçš„ä½œç”¨èŒƒå›´ã€‚å½“ checkwitness ç”¨äºäº¤æ˜“éªŒè¯æ—¶ï¼Œé™¤äº¤æ˜“å‘é€è€… sender å¤–ï¼Œå…¶ä»–çš„ signers éƒ½éœ€è¦å®šä¹‰å…¶ç­¾åçš„ä½œç”¨èŒƒå›´ã€‚è¯¦æƒ…è¯·å‚è§ [ç­¾åä½œç”¨åŸŸ](#signature-scope)ã€‚

| å­—æ®µ | è¯´æ˜|  ç±»å‹|
|--------------|------------------| --|
| `Account`   | è´¦æˆ·è„šæœ¬å“ˆå¸Œ  |  `UInt160` |
| `Scopes` | æŒ‡å®šç­¾åçš„ä½œç”¨èŒƒå›´   |  `WitnessScope` |
| `AllowedContracts`  |  ç­¾åå¯éªŒè¯çš„åˆçº¦è„šæœ¬æ•°ç»„   | `UInt160[]` |
| `AllowedGroups` | ç­¾åå¯éªŒè¯çš„åˆçº¦ç»„å…¬é’¥ | `ECPoint[]` |
| `Rules` | å½“ `scopes` è®¾ç½®ä¸º`WitnessRules` æ—¶ï¼Œå¡«å†™ç­¾åè§„åˆ™æ•°ç»„ | `WitnessRules[]` |

### sysfee
ç³»ç»Ÿè´¹ç”¨å–å†³äºäº¤æ˜“è„šæœ¬çš„å¤§å°ï¼Œæ•°é‡å’ŒNeoVMæŒ‡ä»¤ç±»å‹ã€‚æ¯ä¸€ä¸ªæŒ‡ä»¤æ‰€å¯¹åº”çš„è´¹ç”¨ï¼Œè¯·å‚è€ƒ[opcode è´¹ç”¨](../è™šæ‹Ÿæœº#è´¹ç”¨)ã€‚Neo N3å–æ¶ˆäº†æ¯ç¬”äº¤æ˜“10 GASçš„å…è´¹é¢åº¦ï¼Œç³»ç»Ÿè´¹ç”¨æ€»é¢å—åˆçº¦è„šæœ¬çš„æŒ‡ä»¤æ•°é‡å’ŒæŒ‡ä»¤ç±»å‹å½±å“ã€‚è®¡ç®—å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š

![](../images/transaction/system_fee.png)

å…¶ä¸­ï¼Œ*OpcodeSet* ä¸ºæŒ‡ä»¤é›†ï¼Œğ‘‚ğ‘ğ‘ğ‘œğ‘‘ğ‘’ğ‘ƒğ‘Ÿğ‘–ğ‘ğ‘’<sub>ğ‘–</sub>ä¸ºç¬¬ *i* ç§æŒ‡ä»¤çš„è´¹ç”¨ï¼Œğ‘›<sub>ğ‘–</sub>ä¸ºç¬¬ *i* ç§æŒ‡ä»¤åœ¨åˆçº¦è„šæœ¬ä¸­çš„æ‰§è¡Œæ¬¡æ•°ã€‚
### netfee
ç½‘ç»œè´¹æ˜¯ç”¨æˆ·å‘Neoç½‘ç»œæäº¤äº¤æ˜“æ—¶æ”¯ä»˜çš„è´¹ç”¨ï¼Œä½œä¸ºå…±è¯†èŠ‚ç‚¹çš„å‡ºå—å¥–åŠ±ã€‚æ¯ç¬”äº¤æ˜“çš„ç½‘ç»œè´¹å­˜åœ¨ä¸€ä¸ªåŸºç¡€å€¼ï¼Œç”¨æˆ·æ”¯ä»˜çš„ç½‘ç»œè´¹éœ€è¦å¤§äºæˆ–ç­‰äºæ­¤åŸºç¡€å€¼ï¼Œå¦åˆ™äº¤æ˜“æ— æ³•é€šè¿‡éªŒè¯ã€‚åŸºç¡€ç½‘ç»œè´¹è®¡ç®—å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š

![network fee](../images/transaction/network_fee.png)

å…¶ä¸­ï¼Œ*VerificationCost*ä¸ºè™šæ‹ŸæœºéªŒè¯äº¤æ˜“ç­¾åæ‰§è¡Œçš„æŒ‡ä»¤ç›¸å¯¹åº”çš„è´¹ç”¨ï¼Œ*tx.Length*ä¸ºäº¤æ˜“æ•°æ®çš„å­—èŠ‚é•¿åº¦ï¼Œ*FeePerByte*ä¸ºäº¤æ˜“æ¯å­—èŠ‚çš„è´¹ç”¨ï¼Œç›®å‰ä¸º0.00001GASã€‚

### attributes
æ ¹æ®å…·ä½“çš„äº¤æ˜“ç±»å‹å…è®¸å‘äº¤æ˜“æ·»åŠ é¢å¤–çš„å±æ€§ã€‚ å¯¹äºæ¯ä¸ªå±æ€§ï¼Œå¿…é¡»æŒ‡å®šä½¿ç”¨ç±»å‹ï¼Œä»¥åŠå¤–éƒ¨æ•°æ®å’Œå¤–éƒ¨æ•°æ®çš„å¤§å°ã€‚

æ¯ä¸ªäº¤æ˜“æœ€å¤šå¯ä»¥æ·»åŠ 16ä¸ªå±æ€§ã€‚

### script
åœ¨NeoVMä¸Šæ‰§è¡Œçš„è„šæœ¬ï¼Œå†³å®šäº†äº¤æ˜“çš„æ•ˆæœã€‚
### witnesses
witnesseså±æ€§ç”¨äºéªŒè¯äº¤æ˜“çš„æœ‰æ•ˆæ€§å’Œå®Œæ•´æ€§ã€‚Witnesså³â€œè§è¯äººâ€ï¼Œ åŒ…å«ä¸¤ä¸ªå±æ€§ã€‚

| å­—æ®µ | è¯´æ˜|
|--------------|------------------|
| `InvocationScript`   | æ‰§è¡Œè„šæœ¬ï¼Œå‘éªŒè¯è„šæœ¬ä¼ é€’å‚æ•°      |
| `VerificationScript` |éªŒè¯è„šæœ¬   |

å¯ä»¥ä¸ºæ¯ä¸ªäº¤æ˜“æ·»åŠ å¤šä¸ªè§è¯äººï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…·æœ‰å¤šæ–¹ç­¾åçš„è§è¯äººã€‚

#### æ‰§è¡Œè„šæœ¬

æ‰§è¡Œè„šæœ¬å¯ä»¥é€šè¿‡

`0x0C(PUSHDATA1) + 0x40(æ•°æ®é•¿åº¦ä¸º64å­—èŠ‚) + ç­¾å`

æ·»åŠ ç­¾åã€‚é‡å¤æ­¤æ­¥ï¼Œå¯ä»¥ä¸ºå¤šæ–¹ç­¾ååˆçº¦æ¨é€å¤šä¸ªç­¾åã€‚

#### éªŒè¯è„šæœ¬

éªŒè¯è„šæœ¬ï¼Œå¸¸è§ä¸ºåœ°å€è„šæœ¬ï¼ŒåŒ…æ‹¬æ™®é€šåœ°å€è„šæœ¬å’Œå¤šç­¾åœ°å€è„šæœ¬ï¼Œè¯¥åœ°å€è„šæœ¬å¯ä»¥ä»é’±åŒ…è´¦æˆ·ä¸­ç›´æ¥è·å–ï¼Œå…¶æ„é€ æ–¹å¼ï¼Œè¯·å‚è€ƒ[é’±åŒ…-åœ°å€](wallets.md#åœ°å€)ï¼›

ä¹Ÿå¯ä»¥ä¸ºè‡ªå®šä¹‰çš„é‰´æƒåˆçº¦è„šæœ¬ã€‚

## äº¤æ˜“åºåˆ—åŒ–

é™¤IPåœ°å€å’Œç«¯å£å·å¤–ï¼ŒNeoä¸­æ‰€æœ‰å˜é•¿çš„æ•´æ•°ç±»å‹éƒ½ä½¿ç”¨å°ç«¯åºå­˜å‚¨ã€‚äº¤æ˜“åºåˆ—åŒ–æ—¶å°†æŒ‰ä»¥ä¸‹å­—æ®µé¡ºåºæ‰§è¡Œåºåˆ—åŒ–æ“ä½œï¼š

| å­—æ®µ| è¯´æ˜|
|----------|------------|
| `version`  | - |
| `nonce`   | - |
| `systemFee`   | - |
| `networkFee`   | -|
| `validUntilBlock`   | - |
| `signers`   | éœ€å…ˆåºåˆ—åŒ–æ•°ç»„é•¿åº¦`WriteVarInt(length)`ï¼Œä¹‹åå†åˆ†åˆ«åºåˆ—åŒ–æ•°ç»„å„ä¸ªå…ƒç´  |
| `attributes`   |éœ€å…ˆåºåˆ—åŒ–æ•°ç»„é•¿åº¦`WriteVarInt(length)`ï¼Œä¹‹åå†åˆ†åˆ«åºåˆ—åŒ–æ•°ç»„å„ä¸ªå…ƒç´  |
| `script`   | éœ€å…ˆåºåˆ—åŒ–æ•°ç»„é•¿åº¦`WriteVarInt(length)`ï¼Œä¹‹åå†åºåˆ—åŒ–å­—èŠ‚æ•°ç»„ |
| `witnesses`   | éœ€å…ˆåºåˆ—åŒ–æ•°ç»„é•¿åº¦`WriteVarInt(length)`ä¹‹åå†åˆ†åˆ«åºåˆ—åŒ–æ•°ç»„å„ä¸ªå…ƒç´  |


> [!Note]
>
> WriteVarInt(value) æ˜¯æ ¹æ®valueçš„å€¼ï¼Œå­˜å‚¨éå®šé•¿ç±»å‹, æ ¹æ®å–å€¼èŒƒå›´å†³å®šå­˜å‚¨å¤§å°ã€‚

| Value å€¼èŒƒå›´ | å­˜å‚¨ç±»å‹ |
|--------------------|--------------|
| value < 0xFD | byte(value) |
| value <= 0xFFFF | 0xFD + ushort(value) |
| value <= 0xFFFFFFFF | 0xFE + uint(value) |
| value > 0xFFFFFFFF | 0xFF + value |

## äº¤æ˜“ç­¾å
äº¤æ˜“ç­¾åæ˜¯å¯¹äº¤æ˜“æœ¬èº«çš„æ•°æ®ï¼ˆä¸åŒ…å«ç­¾åæ•°æ®ï¼Œå³witnesseséƒ¨åˆ†ï¼‰è¿›è¡ŒECDSAæ–¹æ³•ç­¾åï¼Œç„¶åå¡«å…¥äº¤æ˜“ä½“ä¸­çš„`witnesses`ã€‚

äº¤æ˜“JSONæ ¼å¼ç¤ºä¾‹ï¼Œå…¶ä¸­scriptä¸witnesseså­—æ®µä½¿ç”¨Base64æ›¿ä»£åŸæœ‰çš„Hexstringç¼–ç ï¼š

```Json
{
  "hash": "0xd2b24b57ea05821766877241a51e17eae06ed66a6c72adb5727f8ba701d995be",
  "size": 265,
  "version": 0,
  "nonce": 739807055,
  "sender": "NMDf1XCbioM7ZrPZAdQKQt8nnx3fWr1wdr",
  "sys_fee": "9007810",
  "net_fee": "1264390",
  "valid_until_block": 2102402,
  "signers": [{
    "account": "0xdf93ea5a0283c01e8cdfae891ff700faad70500e",
    "scopes": "FeeOnly"
  },
  {
    "account": "0xdf93ea5a0283c01e8cdfae891ff700faad70500e",
    "scopes": "CalledByEntry"
  }],
  "attributes": [],
  "script": "EQwUDlBwrfoA9x+Jrt+MHsCDAlrqk98MFA5QcK36APcfia7fjB7AgwJa6pPfE8AMCHRyYW5zZmVyDBSJdyDYzXb08Aq/o3wO3YicII/em0FifVtSOA==",
  "witnesses": [{
    "invocation": "DEDy/g4Lt+FTMBHHF84TSVXG9aSNODOjj0aPaJq8uOc6eMzqr8rARqpB4gWGXNfzLyh9qKvE++6f6XoZeaEoUPeH",
    "verification": "DCECCJr46zTvjDE0jA5v5jrry4Wi8Wm7Agjf6zGH/7/1EVELQQqQatQ="
  }]
}
```

## ç­¾åä½œç”¨åŸŸ

åœ¨ Neo Legacy ä¸­ï¼Œäº¤æ˜“ç­¾åæ˜¯å…¨å±€æœ‰æ•ˆçš„ï¼Œæ‰€æœ‰åˆçº¦å‡å¯ä½¿ç”¨ç”¨æˆ·ç­¾åã€‚ä¸ºäº†è®©ç”¨æˆ·èƒ½æ›´ç»†ç²’åº¦åœ°æ§åˆ¶ç­¾åçš„ä½œç”¨èŒƒå›´ï¼ŒNeo N3 æ–°å¢äº†ç­¾åä½œç”¨åŸŸï¼ˆWitnessScopeï¼‰ï¼Œå¯¹äº¤æ˜“ç»“æ„ä¸­çš„ signers å­—æ®µè¿›è¡Œäº†å˜æ›´ï¼Œå¯å®ç°ç­¾ååªé™äºéªŒè¯æŒ‡å®šåˆçº¦çš„åŠŸèƒ½ï¼Œé˜²æ­¢æœªç»æˆæƒçš„åˆçº¦éšæ„ä½¿ç”¨ç”¨æˆ·ç­¾åã€‚

### Scopes

åœ¨æ„é€ äº¤æ˜“æ—¶ï¼Œéœ€è¦æŒ‡å®š `signers` å‚æ•°ä¸­çš„ `scopes` å­—æ®µï¼Œå…¶å®šä¹‰äº†ç­¾åçš„ä½œç”¨èŒƒå›´ï¼ŒåŒ…å«çš„ç±»å‹å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚

| å€¼   | åç§°              | è¯´æ˜                                                         |
| ---- | ----------------- | ------------------------------------------------------------ |
| 0x00 | `None`            | ä»…å¯¹äº¤æ˜“ç­¾åï¼Œä¸å…è®¸ä»»ä½•åˆçº¦ä½¿ç”¨è¯¥ç­¾å                       |
| 0x01 | `CalledByEntry`   | ç­¾ååªé™äºç”± Entry è„šæœ¬è°ƒç”¨çš„åˆçº¦è„šæœ¬ï¼Œå»ºè®®ä½œä¸ºé’±åŒ…çš„é»˜è®¤ç­¾åä½œç”¨ã€‚ |
| 0x10 | `CustomContracts` | è‡ªå®šä¹‰åˆçº¦ï¼Œåœ¨æŒ‡å®šçš„åˆçº¦ä¸­å¯ä»¥ä½¿ç”¨è¯¥ç­¾åã€‚å¯ä¸ CalledByEntry é…åˆä½¿ç”¨ã€‚ |
| 0x20 | `CustomGroups`    | è‡ªå®šä¹‰åˆçº¦ç»„ï¼Œåœ¨æŒ‡å®šçš„åˆçº¦ç»„ä¸­å¯ä»¥ä½¿ç”¨è¯¥ç­¾åã€‚å¯ä¸ CalledByEntry é…åˆä½¿ç”¨ã€‚ |
| 0x80 | `Global`          | ç­¾åå…¨å±€æœ‰æ•ˆï¼Œæ‰€æœ‰åˆçº¦å‡å¯ä½¿ç”¨ç­¾åã€‚é£é™©æé«˜ï¼Œåˆçº¦æœ‰å¯èƒ½ä¼šè½¬ç§»åœ°å€ä¸­çš„æ‰€æœ‰èµ„äº§ï¼Œä»…åœ¨æå…¶ä¿¡ä»»è¯¥åˆçº¦æ—¶é€‰æ‹©ã€‚ |
| 0x40 | `WitnessRules`    | ç”¨æˆ·è‡ªå·±æŒ‡å®šéªŒç­¾è§„åˆ™å’ŒèŒƒå›´ï¼Œå‚è§ä¸‹èŠ‚è¯´æ˜ã€‚                   |

ä¸ºäº†æ›´å¥½åœ°è¯´æ˜å„ç±»å‹ï¼Œæˆ‘ä»¬å‡è®¾ä¸€æ¡åˆçº¦è°ƒç”¨é“¾ä¸ºï¼š **[entry]->[åˆçº¦A]->[åˆçº¦B]->[åˆçº¦C]...->[Target]**

Target åˆçº¦è°ƒç”¨ CheckWitness éªŒç­¾ï¼Œä¸”ç”¨æˆ·èµ‹äºˆäº†ç­¾åã€‚å½“ scopes åˆ†åˆ«è®¾ç½®ä¸ºä»¥ä¸‹å€¼æ—¶ï¼ŒéªŒç­¾æƒ…å†µå¦‚ä¸‹ï¼š

- `None` - **Target** åˆçº¦ä½äºä»»ä½•ä½ç½®æ—¶éƒ½ä¸å…è®¸éªŒç­¾é€šè¿‡
- `Global` - **Target** åˆçº¦ä½äºä»»ä½•ä½ç½®æ—¶éƒ½å…è®¸éªŒç­¾é€šè¿‡
- `CallByEntry` - **Target** åˆçº¦ä½äº **entry**  æˆ– **åˆçº¦A** æ—¶æ‰å…è®¸éªŒç­¾é€šè¿‡
- `CustomContracts` - æ­¤æ—¶ç”¨æˆ·éœ€è¦é¢å¤–æŒ‡å®šä¸€ä¸ªåˆçº¦åˆ—è¡¨ **CustomContracts**ï¼Œä»…å½“ **Target** åˆçº¦å±äº **CustomContracts** ä¸­æ—¶å…è®¸éªŒç­¾é€šè¿‡
- `CustomGroups` - æ­¤æ—¶ç”¨æˆ·éœ€è¦é¢å¤–æŒ‡å®šä¸€ä¸ª Group å…¬é’¥åˆ—è¡¨ **CustomGroups**ï¼Œä»…å½“ **Target** åˆçº¦å¸¦æœ‰ **CustomGroups** ä¸­ä»»æ„ä¸€ä¸ªå…¬é’¥è®¤è¯æ—¶ï¼Œå…è®¸éªŒç­¾é€šè¿‡

### WitnessRule

Action(Allow|Deny) å’Œ Condition (åˆ¤æ–­æ¡ä»¶)

æ‰§è¡Œé€»è¾‘ï¼šå…ˆæ‰§è¡Œåˆ¤æ–­æ¡ä»¶ï¼Œå¦‚æœç¬¦åˆï¼Œåˆ™è¿”å›Actionï¼Œè¿”å›Allowä»£è¡¨éªŒç­¾æˆåŠŸï¼ŒDenyä»£è¡¨éªŒç­¾å¤±è´¥ã€‚

#### WitnessCondition åˆ¤æ–­æ¡ä»¶

- Booleanï¼štrue|false

  â€œexpressionâ€ = <bool>

  ```
  // ç­‰ä»·äº WitnessScope.Global
  {
      "account": "NdUL5oDPD159KeFpD5A9zw5xNF1xLX6nLT",
      "scopes": "WitnessRules",
      "rules": [{
              "action": "Allow",
              "condition": {
                  "type": "Boolean",
                  "expression": true
              }
          }
      ]
  }
  ```

- Not: é€»è¾‘éï¼Œå¯¹å…¶å®ƒæ¡ä»¶æ±‚å

  â€œexpressionâ€=<Condition>

  ```
  // åªæœ‰å½“å‰åˆçº¦ä¸æ˜¯ 0xef4073a0f2b305a38ec4050e4d3d28bc40ea63f5 æ‰å…è®¸ä½¿ç”¨ç­¾å
  {
      "account": "NdUL5oDPD159KeFpD5A9zw5xNF1xLX6nLT",
      "scopes": "WitnessRules",
      "rules": [{
              "action": "Allow",
              "condition": {
                  "type": "Not",
                  "expression": {
                      "type": "ScriptHash",
                      "hash": "0xef4073a0f2b305a38ec4050e4d3d28bc40ea63f5"
                  }
              }
          }
      ]
  }
  
  ```

- Andï¼šé€»è¾‘ä¸ï¼Œè¿æ¥å…¶å®ƒæ¡ä»¶æ±‚ä¸

  â€œexpressionsâ€=<Condition[]>

  ```
  // åªæœ‰å½“å‰åˆçº¦æ˜¯ 0xef4073a0f2b305a38ec4050e4d3d28bc40ea63f5 ä¸”åœ¨å…¥å£å¤„è°ƒç”¨æ—¶æ‰å…è®¸ä½¿ç”¨ç­¾å
  {
      "account": "NdUL5oDPD159KeFpD5A9zw5xNF1xLX6nLT",
      "scopes": "WitnessRules",
      "rules": [{
              "action": "Allow",
              "condition": {
                  "type": "And",
                  "expressions": [{
                          "type": "ScriptHash",
                          "hash": "0xef4073a0f2b305a38ec4050e4d3d28bc40ea63f5"
                      }, {
                          "type": "CalledByEntry"
                      }
                  ]
              }
          }
      ]
  }
  ```

- Orï¼šé€»è¾‘æˆ–ï¼Œè¿æ¥å…¶å®ƒæ¡ä»¶æ±‚æˆ–

  â€œexpressionsâ€=<Condition[]>

  ```
  // åªæœ‰å½“å‰åˆçº¦æ˜¯ 0xef4073a0f2b305a38ec4050e4d3d28bc40ea63f5 æˆ–åœ¨å…¥å£å¤„è°ƒç”¨æ—¶æ‰å…è®¸ä½¿ç”¨ç­¾å
  {
      "account": "NdUL5oDPD159KeFpD5A9zw5xNF1xLX6nLT",
      "scopes": "WitnessRules",
      "rules": [{
              "action": "Allow",
              "condition": {
                  "type": "Or",
                  "expressions": [{
                          "type": "ScriptHash",
                          "hash": "0xef4073a0f2b305a38ec4050e4d3d28bc40ea63f5"
                      }, {
                          "type": "CalledByEntry"
                      }
                  ]
              }
          }
      ]
  }
  ```

- ScriptHashï¼šéªŒè¯å½“å‰åˆçº¦hashæ˜¯å¦åŒ¹é…ï¼Œç›¸å½“äº CustomContracts

  â€œhashâ€= <UInt160>

  ```
  // åªå…è®¸åˆçº¦ 0xef4073a0f2b305a38ec4050e4d3d28bc40ea63f5 ä½¿ç”¨ç­¾å
  {
      "account": "NdUL5oDPD159KeFpD5A9zw5xNF1xLX6nLT",
      "scopes": "WitnessRules",
      "rules": [{
              "action": "Allow",
              "condition": {
                  "type": "ScriptHash",
                  "hash": "0xef4073a0f2b305a38ec4050e4d3d28bc40ea63f5"
              }
          }
      ]
  }
  ```

- Groupï¼šéªŒè¯å½“å‰åˆçº¦çš„å…¬é’¥æ˜¯å¦åŒ¹é…ï¼Œç›¸å½“äº CustomGroups

  â€œgroupâ€=<ECPoint>

  ```
  // åªå…è®¸ç»è¿‡å…¬é’¥ 021821807f923a3da004fb73871509d7635bcc05f41edef2a3ca5c941d8bbc1231è®¤è¯çš„åˆçº¦ä½¿ç”¨ç­¾å
  {
      "account": "NdUL5oDPD159KeFpD5A9zw5xNF1xLX6nLT",
      "scopes": "WitnessRules",
      "rules": [{
              "action": "Allow",
              "condition": {
                  "type": "Group",
                  "group": "021821807f923a3da004fb73871509d7635bcc05f41edef2a3ca5c941d8bbc1231"
              }
          }
      ]
  }
  ```

- CalledByEntryï¼šéªŒè¯å½“å‰åˆçº¦æ˜¯å¦ä¸ºentryè°ƒç”¨ï¼Œç›¸å½“äº CallByEntry

  ```
  // ç­‰ä»·äº WitnessScope.CallByEntry
  {
      "account": "NdUL5oDPD159KeFpD5A9zw5xNF1xLX6nLT",
      "scopes": "WitnessRules",
      "rules": [{
              "action": "Allow",
              "condition": {
                  "type": "CalledByEntry"
              }
          }
      ]
  }
  ```

- CalledByContractï¼šéªŒè¯å½“å‰åˆçº¦çš„ä¸Šä¸€çº§åˆçº¦hashæ˜¯å¦åŒ¹é…

  â€œhashâ€=<UInt160>

  ```
  // åªå…è®¸ä¸Šçº§åˆçº¦æ˜¯ 0xef4073a0f2b305a38ec4050e4d3d28bc40ea63f5 æ—¶ä½¿ç”¨ç­¾å
  {
      "account": "NdUL5oDPD159KeFpD5A9zw5xNF1xLX6nLT",
      "scopes": "WitnessRules",
      "rules": [{
              "action": "Allow",
              "condition": {
                  "type": "CalledByContract",
                  "hash": "0xef4073a0f2b305a38ec4050e4d3d28bc40ea63f5"
              }
          }
      ]
  }
  ```

- CalledByGroupï¼šéªŒè¯å½“å‰åˆçº¦çš„ä¸Šä¸€çº§åˆçº¦å…¬é’¥æ˜¯å¦åŒ¹é…

  â€œgroupâ€=<UInt160>

  ```
  // åªå…è®¸ä¸Šçº§åˆçº¦æ˜¯å…¬é’¥ 021821807f923a3da004fb73871509d7635bcc05f41edef2a3ca5c941d8bbc1231 è®¤è¯è¿‡çš„åˆçº¦æ—¶ä½¿ç”¨ç­¾å
  {
      "account": "NdUL5oDPD159KeFpD5A9zw5xNF1xLX6nLT",
      "scopes": "WitnessRules",
      "rules": [{
              "action": "Allow",
              "condition": {
                  "type": "CalledByGroup",
                  "group": "021821807f923a3da004fb73871509d7635bcc05f41edef2a3ca5c941d8bbc1231"
              }
          }
      ]
  } 
  ```

### ç¤ºä¾‹

è¯¥å­—æ®µç›®å‰åªèƒ½é€šè¿‡SDKæ„é€ äº¤æ˜“æ—¶å®šä¹‰ã€‚ä¸ºäº†å¸®åŠ©ç†è§£ï¼Œå¯å‚è€ƒ JSON æ ¼å¼çš„ä»£ç ç¤ºä¾‹ï¼š

```json
{
    "account": "NdUL5oDPD159KeFpD5A9zw5xNF1xLX6nLT",
    "scopes": "WitnessRules",
    "rules": [{
            "action": "Allow",
            "condition": {
                "type": "Not",
                "expression": {
                    "type": "And",
                    "expressions": [{
                            "type": "ScriptHash",
                            "hash": "0xef4073a0f2b305a38ec4050e4d3d28bc40ea63f5"
                        }, {
                            "type": "CalledByEntry"
                        }
                    ]
                }
            }
        }
    ]
}
```

